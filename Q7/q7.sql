select book_id, title, pyear from(select bo.book_id, bo.title, bo.pyear, rank() over (order by count(*) desc) as book_rank from borrowings b join books bo on b.book_id = bo.book_id group by bo.book_id, bo.title, bo.pyear) as rank where book_rank <= 3;
