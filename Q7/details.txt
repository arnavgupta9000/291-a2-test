agent: NA
Details: this was by far the hardest query for me the rank over really didnt make sense but i think i got it. the intution is using rank over count the amount of borrowed books and then rank them desc while the ranking is <=3. So for that we have the normal select statement and in the from clause we have a nested select statement. Note that this is different form before as now its not in the select statement but rather in the from clause and this is because we dont acctually wanna see the ranking. Now we use rank() over to rank them and oder it by count() which will count the borrowed books. use desc for descending order. now we use a join clause (equivalent to a where clause here) and finally end it off with book_rank <=3. Note, rank over will return tied rankings the same ranking and rank <=3 will check if the rank number is <=3. so if 5 books are tied for #1st place, they will all get ranked 1, and 1 is indeed <=3 so they will all show up. the next book will get ranked 6, and 6 >= 3 so it will not show up.
