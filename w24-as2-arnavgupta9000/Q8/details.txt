agent: NA.
Details: Intuition: find out the all reqs needed in the select clause, and use the where clause to join AND use group by to then using having to filter out people with 0 penalties. The hardest part of this was obviously sum(case when p.paid_amount >= p.amount then 1 else 0 end) as PENALITIES, sum(case when p.paid_amount >= p.amount then p.amount else 0 end). https://www.w3schools.com/sql/sql_case.asp, https://www.sqlitetutorial.net/sqlite-case/. Here's out it works, the sum part sums value and if paid_amout > p.amout then 1 else 0 basically means the (expression if a else b in python) so if paid_amount > amout then we get 1 else 0. THEN we sum up all the amounts thus gaining our entire total. Similar reasoning can be used with sum(case when p.paid_amount >= p.amount then p.amount else 0 end) as its the exact same idea except if true we take the amount they paid. NOTICE end is used to end the logic as per the synatx. the rest is easy, only other thing mentioning is that we have the group by clause to allow us the having clause.
