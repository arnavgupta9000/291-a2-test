agent: NA
Details: This query is much easier than the last one. we first start with selecting what we need and from where we need it. we use group by so that we then have access to using 'having'. in the having claus we set count equal to a big expression. inside this big expression we first use sum() to sum over everythiing (where 1 = yes it meets the req, 0 = no it doesnt meet the reqs). inside the sum we have a case statement checking if the rating > 3.5 (as per reqs) and if the request count which we got from q9 is > the avg(request count). If both of these are true, add 1 to the statement else add 0 thus ending our query. select distinct email from borrowings b, members m, book_info info where m.email = b.member and info.book_id = b.book_id group by m.email having count(*) = sum(case when info.rating > 3.5 and info.reqcnt > (select avg (reqcnt) from book_info) then 1 else 0 end); Note distinct is used to ensure to duplicates.
