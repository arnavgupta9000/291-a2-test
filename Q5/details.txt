agent: NA
Details: this questions wasnt bad IF I DIDNT misunderstand it at first and thought we had to filter the top 3 reviews of each book, not the books themselves... so the intuition is just to use the avg and count keywords and with the limit <=3. We can do this by putting limit 3 at the end. We use order by aver desc to make the books in descending where aver = avg(rating) as aver. this just gets the average rating.bo.book_id group by bo.book_id, title having count(*) >=2 this is the join coniditon which is very standard and then we use count(*) to count all of the occurances. this gives the final query as select distinct bo.book_id, title, avg(rating) as aver from reviews r, books bo where r.book_id = bo.book_id group by bo.book_id, title having count(*) >=2 order by aver desc limit 3; where distinct is to make sure no rows are indentical. notice the group by is required since we have a having clause.
